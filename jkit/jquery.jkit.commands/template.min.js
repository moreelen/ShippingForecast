
// jQuery Plugin: jKit
// A very easy to use, cross platform jQuery UI toolkit that's still small in size, has the features you need and doesn't get in your way.
// Version 1.2.16 - 10. May. 2013
// http://jquery-jkit.com/
//
// by Fredi Bach
// http://fredibach.ch/jquery-plugins/

plugin.commands.template=function(){var a={};a.templates={},plugin.addCommandDefaults("template",{action:"set",name:"template",dynamic:"no",addhtml:"+"}),a.execute=function(c,d){var e=plugin.settings;if("apply"==d.action){if($el=c,void 0!=d.children&&""!=d.children){$el=c.children(d.children);var f=0;$el.each(function(){f++,b($(this),d,f,$el.length)})}else b(c,d);"yes"==d.dynamic&&$("<a/>",{"class":e.prefix+"-"+type+"-add"}).html(d.addhtml).on("click",function(){$el=$(c.get(0));var a=$el.children(d.children).length+1;$el.find(".if-entry-last").hide(),b($("<"+d.children+"/>").appendTo($el),d,a,a),plugin.triggerEvent("added",c,d)}).insertAfter(c)}else{if(void 0==a.templates[d.name]&&(a.templates[d.name]=[]),void 0==d.vars)var h=[];else var h=d.vars.split(e.delimiter);a.templates[d.name]={template:c.detach(),vars:h}}};var b=function(b,d,e,f){var g={};$.each(a.templates[d.name].vars,function(a,c){var d=b.find("."+c);plugin.init(d),g[c]=""!=d.val()?d.val():d.html()}),b.html(a.templates[d.name].template.clone().show()),b.find('[class^="if-entry-"]').hide(),c(b,e),$.each(a.templates[d.name].vars,function(a,c){var d=b.find("."+c);d.is("input")||d.is("select")||d.is("textarea")?d.val(g[c]):d.html(g[c]),void 0==g[c]&&b.find(".if-"+c).length>0&&b.find(".if-"+c).remove(),1==e&&b.find(".if-entry-first").show(),e==f&&b.find(".if-entry-last").show(),b.find(".if-entry-nr-"+e).show()})},c=function(a,b){a.find('[class^="dynamic-"]').each(function(){var a=$(this),c=$(this).attr("class").split(/\s+/);$.each(c,function(c,d){var e=d.substr(8);if(""!=e&&a.attr(e)){var f=a.attr(e),g=f.lastIndexOf("_");g>-1&&(f=f.substr(0,g)),a.attr(e,f+"_"+b)}})})};return a}();
