
// jQuery Plugin: jKit
// A very easy to use, cross platform jQuery UI toolkit that's still small in size, has the features you need and doesn't get in your way.
// Version 1.2.16 - 10. May. 2013
// http://jquery-jkit.com/
//
// by Fredi Bach
// http://fredibach.ch/jquery-plugins/

plugin.commands.lightbox=function(){var a={},b={};return plugin.addCommandDefaults("lightbox",{speed:500,opacity:.7,clearance:200,closer:"x",next:">",prev:"<",modal:"no",width:"",height:"",titleHeight:20,group:""}),a.execute=function(a,c){var d=plugin.settings,e="lightbox",f="";void 0!==a.attr("href")&&(f=a.attr("href")),""==f&&void 0!==a.attr("src")&&(f=a.attr("src")),""==f&&void 0!==a.css("background-image")&&(f=a.css("background-image").replace('"',"").replace('"',"").replace("url(","").replace(")","")),""!=f&&(""!=c.group&&(void 0==b[c.group]&&(b[c.group]=[]),b[c.group].push(a)),a.on("click",function(){plugin.triggerEvent("clicked",a,c),"no"==c.modal&&$("<div/>",{id:d.prefix+"-"+e+"-bg","class":d.prefix+"-"+e+"-closer "+d.prefix+"-"+e+"-el"}).fadeTo(c.speed,c.opacity).appendTo("body");var h=$("<div/>",{id:d.prefix+"-"+e+"-content","class":d.prefix+"-"+e+"-el"}).fadeTo(0,.01).appendTo("body");$.fn.jKit_iOS()&&h.css("top",$(window).scrollTop()+"px"),""!=c.width&&(h.css({width:c.width}),h.css({left:($(window).width()-h.outerWidth())/2+"px"})),""!=c.height&&(h.css({height:c.height}),h.css({top:($(window).height()-h.outerHeight())/2+"px"}));var i=$("<div/>",{id:d.prefix+"-"+e+"-nav","class":d.prefix+"-"+e+"-el"}).hide().fadeTo(c.speed,1).appendTo("body");$("<span/>",{"class":d.prefix+"-"+e+"-closer"}).html(c.closer).prependTo(i);var k=h.offset();if(i.css({top:k.top-c.titleHeight-$(window).scrollTop()+"px",left:k.left+h.outerWidth()-i.width()+"px"}),""!=c.group){var l=$("<span/>",{id:d.prefix+"-"+e+"-nav-next"}).prependTo(i),m=$("<span/>",{id:d.prefix+"-"+e+"-nav-prev"}).prependTo(i);plugin.addKeypressEvents(l,"right"),plugin.addKeypressEvents(m,"left"),b[c.group][b[c.group].length-1]!=a&&l.html(c.next).on("click right",function(){$.each(b[c.group],function(d,f){f==a&&($("."+plugin.settings.prefix+"-"+e+"-el").fadeTo(c.speed,0,function(){$(this).remove()}),b[c.group][d+1].click())})}),b[c.group][0]!=a&&m.html(c.prev).on("click left",function(){$.each(b[c.group],function(d,f){f==a&&($("."+plugin.settings.prefix+"-"+e+"-el").fadeTo(c.speed,0,function(){$(this).remove()}),b[c.group][d-1].click())})})}$title=$("<div/>",{id:d.prefix+"-"+e+"-title","class":d.prefix+"-"+e+"-el"}).css({top:k.top-c.titleHeight-$(window).scrollTop()+"px",left:k.left+"px",width:h.width()+"px"}).hide().text(a.attr("title")).fadeTo(c.speed,1).appendTo("body"),$.support.leadingWhitespace||(f=f+"?"+(new Date).getTime());var n=new Image;return $(n).load(function(){var b=($(this).outerWidth()+c.clearance)/$(window).width(),d=($(this).outerHeight()+c.clearance)/$(window).height(),e=Math.max(b,d);if(e>1){var f=$(this).height();$(this).width($(this).width()/e),$(this).height(f/e)}var g=($(window).width()-$(this).outerWidth())/2,j=($(window).height()-$(this).outerHeight())/2;h.width($(this).width()).height($(this).height()).css({left:g+"px",top:j+"px"}).fadeTo(c.speed,1),$(this).hide().fadeTo(c.speed,1),""!=a.attr("title")&&$title.css({top:j-c.titleHeight+"px",left:g+"px",width:$(this).width()+"px"}),i.css({top:j-c.titleHeight+"px",left:g+h.outerWidth()-i.width()+"px"})}).attr("src",f).appendTo(h).error(function(){h.html('<iframe id="'+d.prefix+"-"+e+'-iframe" src="'+f+'" style="border:none;width:100%;height:100%"></iframe>').fadeTo(c.speed,1)}),$("."+d.prefix+"-"+e+"-closer").click(function(){$("."+d.prefix+"-"+e+"-el").fadeTo(c.speed,0,function(){$(this).remove()})}),!1}))},plugin.closeLightbox=function(){$("."+plugin.settings.prefix+"-lightbox-el").fadeTo("fast",0,function(){$(this).remove()})},a}();
